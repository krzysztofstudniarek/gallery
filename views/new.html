<!DOCTYPE html>
<html lang="en">
% include('head.html')
<script type="text/javascript" src="script/plupload.full.min.js"></script>
<body>
  % include('header.html')
  <div class="container">
    <div class="row">
        <form action="\new" method="post">
        <div class="form-group">
            <label for="name">Gallery name:</label>
            <input type="text" class="form-control" id="name" placeholder="Gallery Name" name="name">
        </div>
        <hr/>
        <h2>Images</h2>
        <div class="form-group">
            <ul id="filelist"></ul>
            <br />
            <label for="browse">Select images:</label>
            <button type="button" id="browse" class="btn btn-primary">Select Imagess</button> 
            &nbsp 
            <button type="button" id="upload" class="btn btn-default">Upload</button>
        </div>
        <hr/>
        <button type="submit" class="btn btn-default">Submit</button>
    </form>
    </div>
  </div>

  <script type="text/javascript">
    
   var uploader = new plupload.Uploader({
           browse_button: 'browse', // this can be an id of a DOM element or the DOM element itself
           runtimes : 'html5,flash,silverlight,html4',
           url : "/upload",
    
           // Maximum file size
           max_file_size : '10mb',
    
           chunk_size: '1mb',
    
           // Specify what files to browse for
           filters : [
               {title : "Image files", extensions : "jpg,jpeg,gif,png"}
           ],
   });
    
   uploader.init();
    
   uploader.bind('FilesAdded', function(up, files) {
     var html = '';
     plupload.each(files, function(file) {
       html += '<li id="' + file.id + '">' + file.name + ' (' + plupload.formatSize(file.size) + ') <b></b></li>';
     });
     document.getElementById('filelist').innerHTML += html;
   });
    
   uploader.bind('UploadProgress', function(up, file) {
     document.getElementById(file.id).getElementsByTagName('b')[0].innerHTML = '<span>' + file.percent + "%</span>";
   });
    
   uploader.bind('Error', function(up, err) {
     document.getElementById('console').innerHTML += "\nError #" + err.code + ": " + err.message;
   });
    
   document.getElementById('upload').onclick = function() {
     uploader.start();
   };
    
   </script>
</body>
</html>